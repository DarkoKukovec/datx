<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>useDatx · datx</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Install"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="useDatx · datx"/><meta property="og:type" content="website"/><meta property="og:url" content="https://datx.dev/"/><meta property="og:description" content="## Install"/><meta property="og:image" content="https://datx.dev/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://datx.dev/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/datx-logo.svg" alt="datx"/><h2 class="headerTitleWithLogo">datx</h2></a><a href="/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/next/getting-started/installation" target="_self">Docs</a></li><li class=""><a href="/docs/next/examples/basic-setup" target="_self">Examples</a></li><li class=""><a href="https://github.com/infinum/datx" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>JSON API SWR</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/getting-started/installation">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/next/getting-started/defining-models">Defining models</a></li><li class="navListItem"><a class="navItem" href="/docs/next/getting-started/references">References</a></li><li class="navListItem"><a class="navItem" href="/docs/next/getting-started/configuring-the-collection">Configuring the collection</a></li><li class="navListItem"><a class="navItem" href="/docs/next/getting-started/using-the-collection">Using the collection</a></li><li class="navListItem"><a class="navItem" href="/docs/next/getting-started/persisting-data-locally">Persisting data locally</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Mixins<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/mixins/what-are-mixins">What are mixins</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mixins/with-actions">withActions</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mixins/with-meta">withMeta</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mixins/with-patches">withPatches</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mixins/network-mixin">Network Mixin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mixins/jsonapi-mixin">JSONAPI Mixin</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mixins/building-your-own-mixin">Build your own mixin</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/collection">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/model">Model</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/view">View</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/attribute">Attribute</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/bucket">Bucket</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/pure-model">Pure Model</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/model-utils">Model utils</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/lib-utils">Lib utils</a></li><li class="navListItem"><a class="navItem" href="/docs/next/api-reference/typescript-interfaces">Typescript interfaces</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Network<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/network/getting-started">Getting started with DatX Network</a></li><li class="navListItem"><a class="navItem" href="/docs/next/network/base-request">BaseRequest</a></li><li class="navListItem"><a class="navItem" href="/docs/next/network/caching">Caching</a></li><li class="navListItem"><a class="navItem" href="/docs/next/network/fetching">Fetching</a></li><li class="navListItem"><a class="navItem" href="/docs/next/network/interceptors">Interceptors</a></li><li class="navListItem"><a class="navItem" href="/docs/next/network/operators">Operators</a></li><li class="navListItem"><a class="navItem" href="/docs/next/network/response">Response</a></li><li class="navListItem"><a class="navItem" href="/docs/next/network/typescript-interfaces">TypeScript interfaces</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">JSON API<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-getting-started">Getting started with JSON API</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-basic-configuration">Basic configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-network-configuration">Network configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-network-usage">Network usage</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-spec-compliance">Spec compliance</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-model">Model</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-collection">Collection</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-view">View</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-response">Response</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-config">Config</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-utils">Utils</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi/jsonapi-typescript-interfaces">Typescript interfaces</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">JSON API Angular<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi-angular/mixin">Angular JSON:API mixin</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">JSON API SWR<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem navListItemActive"><a class="navItem" href="/docs/next/jsonapi-swr/overview">useDatx</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jsonapi-swr/api">API</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Migration guide<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/migration-guide/breaking-changes">Breaking changes since v1</a></li><li class="navListItem"><a class="navItem" href="/docs/next/migration-guide/deprecations">Deprecations in v2</a></li><li class="navListItem"><a class="navItem" href="/docs/next/migration-guide/whats-new">What&#x27;s new</a></li><li class="navListItem"><a class="navItem" href="/docs/next/migration-guide/from-v1">Migration from v1</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Testing<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/testing/test-data-factory">Test data factory</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Troubleshooting<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/next/troubleshooting/known-issues">Known issues</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">useDatx</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="install"></a><a href="#install" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install</h2>
<pre><code class="hljs css language-bash">npm install --save swr @datx/swr
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="basic-usage-with-nextjs"></a><a href="#basic-usage-with-nextjs" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic usage with Next.js</h2>
<h3><a class="anchor" aria-hidden="true" id="datx-client-initializer-function"></a><a href="#datx-client-initializer-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Datx Client initializer function</h3>
<p>For extra SSR setup, see <a href="#ssr">SSR Setup section</a></p>
<pre><code class="hljs css language-ts"><span class="hljs-comment">// src/datx/createClient.ts</span>

<span class="hljs-keyword">import</span> { Collection } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/core'</span>;
<span class="hljs-keyword">import</span> { CachingStrategy, config } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/jsonapi'</span>;
<span class="hljs-keyword">import</span> { jsonapiSwrClient } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/swr'</span>;

<span class="hljs-keyword">import</span> { Post } <span class="hljs-keyword">from</span> <span class="hljs-string">'../models/Post'</span>;
<span class="hljs-keyword">import</span> { Todo } <span class="hljs-keyword">from</span> <span class="hljs-string">'../models/Todo'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> JsonapiSwrClient <span class="hljs-keyword">extends</span> jsonapiSwrClient(Collection) {
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> types = [Todo, Post];
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createClient</span>(<span class="hljs-params"></span>) </span>{
  config.baseUrl = process.env.NEXT_PUBLIC_JSONAPI_URL <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;
  config.cache = CachingStrategy.NetworkOnly;

  <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> JsonapiSwrClient();

  <span class="hljs-keyword">return</span> client;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> Client = <span class="hljs-keyword">typeof</span> JsonapiSwrClient;
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="client-types-override"></a><a href="#client-types-override" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Client types override</h3>
<p>To correctly infer types form expression in <code>useDatx</code> you need to globally override client typings.</p>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// /typings/datx.d.ts</span>

<span class="hljs-keyword">import</span> { Client } <span class="hljs-keyword">from</span> <span class="hljs-string">'../src/datx/createClient'</span>;

<span class="hljs-keyword">declare</span> <span class="hljs-keyword">module</span> '@datx/swr' {
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> IClient <span class="hljs-keyword">extends</span> Client {
    types: Client[<span class="hljs-string">'types'</span>];
  }
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="client-initialization"></a><a href="#client-initialization" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Client initialization</h3>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// src/pages/_app.tsx</span>

<span class="hljs-keyword">import</span> <span class="hljs-string">'@datx/core/disable-mobx'</span>;

<span class="hljs-keyword">import</span> type { AppProps } <span class="hljs-keyword">from</span> <span class="hljs-string">'next/app'</span>;
<span class="hljs-keyword">import</span> { createFetcher, DatxProvider, useInitialize } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/swr'</span>;
<span class="hljs-keyword">import</span> { createClient } <span class="hljs-keyword">from</span> <span class="hljs-string">'../datx/createClient'</span>;
<span class="hljs-keyword">import</span> { SWRConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'swr'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExampleApp</span>(<span class="hljs-params">{ Component, pageProps }: AppProps</span>) </span>{
  <span class="hljs-keyword">const</span> client = useInitialize(createClient);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DatxProvider</span> <span class="hljs-attr">client</span>=<span class="hljs-string">{client}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">SWRConfig</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">fetcher:</span> <span class="hljs-attr">createFetcher</span>(<span class="hljs-attr">client</span>),
        }}
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Component</span> {<span class="hljs-attr">...pageProps</span>} /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">SWRConfig</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">DatxProvider</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ExampleApp;
</code></pre>
<p>For more details how to disable Mobx see <a href="#disable-mobx">Disable Mobx</a> section.</p>
<h3><a class="anchor" aria-hidden="true" id="define-models"></a><a href="#define-models" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Define models</h3>
<pre><code class="hljs css language-ts"><span class="hljs-comment">// src/models/Post.ts</span>

<span class="hljs-keyword">import</span> { Attribute, PureModel } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/core'</span>;
<span class="hljs-keyword">import</span> { jsonapiModel } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/jsonapi'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> Post <span class="hljs-keyword">extends</span> jsonapiModel(PureModel) {
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> readonly <span class="hljs-keyword">type</span> = <span class="hljs-string">'posts'</span>;

  <span class="hljs-meta">@Attribute</span>({ isIdentifier: <span class="hljs-literal">true</span> })
  id!: <span class="hljs-built_in">number</span>;

  <span class="hljs-meta">@Attribute</span>()
  title!: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@Attribute</span>()
  body!: <span class="hljs-built_in">string</span>;
}
</code></pre>
<pre><code class="hljs css language-ts"><span class="hljs-comment">// src/models/Todo.ts</span>

<span class="hljs-keyword">import</span> { Attribute, PureModel } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/core'</span>;
<span class="hljs-keyword">import</span> { jsonapiModel } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/jsonapi'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> Todo <span class="hljs-keyword">extends</span> jsonapiModel(PureModel) {
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> readonly <span class="hljs-keyword">type</span> = <span class="hljs-string">'todos'</span>;

  <span class="hljs-meta">@Attribute</span>({ isIdentifier: <span class="hljs-literal">true</span> })
  id!: <span class="hljs-built_in">number</span>;

  <span class="hljs-meta">@Attribute</span>()
  message!: <span class="hljs-built_in">string</span>;
}
</code></pre>
<blockquote>
<p>It's important to use <code>readonly</code> in <code>public static readonly type = 'posts';</code>. It helps TS to infer the typings in <code>useDatx</code> without the need to manually pass generics.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="define-queries"></a><a href="#define-queries" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Define queries</h3>
<p>Using expression types (Preferred):</p>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">import</span> { IGetManyExpression } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/swr'</span>;

<span class="hljs-keyword">import</span> { Todo } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../models/Todo'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> todosQuery: IGetManyExpression&lt;<span class="hljs-keyword">typeof</span> Todo&gt; = {
  op: <span class="hljs-string">'getMany'</span>,
  <span class="hljs-keyword">type</span>: <span class="hljs-string">'todos'</span>,
};
</code></pre>
<p>Using <code>as const</code>:</p>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">import</span> { Todo } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../models/Todo'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> todosQuery = {
  op: <span class="hljs-string">'getMany'</span>,
  <span class="hljs-keyword">type</span>: <span class="hljs-string">'todos'</span>,
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;
</code></pre>
<blockquote>
<p>It's important to use <code>as const</code> assertion. It tells the compiler to infer the narrowest or most specific type it can for an expression. If you leave it off, the compiler will use its default type inference behavior, which will possibly result in a wider or more general type.</p>
</blockquote>
<p>If your project uses TypeScript 4.9 or newer you can use <code>satisfies</code> to limit the type:</p>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">import</span> { Todo } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../models/Todo'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> todosQuery = {
  op: <span class="hljs-string">'getMany'</span>,
  <span class="hljs-keyword">type</span>: <span class="hljs-string">'todos'</span>,
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> satisfies IGetManyExpression&lt;<span class="hljs-keyword">typeof</span> Todo&gt;;
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="query-naming-convention"></a><a href="#query-naming-convention" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Query naming convention</h3>
<p>Query can be a static object or a function. Both cases should be suffixed with <code>query</code> to make it clear that it's a query.
If you use a function, it's recommended to add <code>get</code> prefix to indicate that it's a getter.</p>
<blockquote>
<p>Rule of thumb is to use <code>get</code> prefix if query depends on some other data.</p>
</blockquote>
<blockquote>
<p>Lazy initializer function is SWR concept used for conditional fetching. You can find more details in <a href="https://swr.vercel.app/docs/conditional-fetching">SWR Conditional Fetching</a> documentation.</p>
</blockquote>
<pre><code class="hljs css language-ts"><span class="hljs-comment">// collection query</span>
<span class="hljs-keyword">const</span> todosQuery = {
  op: <span class="hljs-string">'getMany'</span>,
  <span class="hljs-keyword">type</span>: <span class="hljs-string">'todos'</span>,
} <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;

<span class="hljs-comment">// single item query</span>
<span class="hljs-keyword">const</span> getTodoQuery = <span class="hljs-function">(<span class="hljs-params">id?: <span class="hljs-built_in">string</span></span>) =&gt;</span>
  id
    ? ({
        id,
        op: <span class="hljs-string">'getOne'</span>,
        <span class="hljs-keyword">type</span>: <span class="hljs-string">'todos'</span>,
      } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> satisfies IGetOneExpression&lt;<span class="hljs-keyword">typeof</span> Todo&gt;)
    : <span class="hljs-literal">null</span>;

<span class="hljs-comment">// related query through primary resource</span>
<span class="hljs-keyword">const</span> getPostCommentsRelationshipQuery = <span class="hljs-function">(<span class="hljs-params">postId?: <span class="hljs-built_in">string</span></span>) =&gt;</span>
  postId
    ? ({
        id: postId,
        op: <span class="hljs-string">'getRelatedResources'</span>,
        relationship: <span class="hljs-string">'comments'</span>,
        <span class="hljs-keyword">type</span>: <span class="hljs-string">'posts'</span>,
      } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> satisfies IGetRelatedResourcesExpression&lt;<span class="hljs-keyword">typeof</span> Post&gt;)
    : <span class="hljs-literal">null</span>;

</code></pre>
<h3><a class="anchor" aria-hidden="true" id="conditional-data-fetching"></a><a href="#conditional-data-fetching" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Conditional data fetching</h3>
<p>Datx SWR supports concept of lazy initializer function. It's a function that returns a query or <code>null</code> if query should not be executed.</p>
<p>Lazy initializer function is SWR concept used for conditional fetching. You can find more details in <a href="https://swr.vercel.app/docs/conditional-fetching">SWR Conditional Fetching</a> documentation.</p>
<h4><a class="anchor" aria-hidden="true" id="simple-conditionally-fetch"></a><a href="#simple-conditionally-fetch" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simple conditionally fetch</h4>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">const</span> { data: post } = useDatx(id ? {
  id,
  op: <span class="hljs-string">'getOne'</span>,
  <span class="hljs-keyword">type</span>: <span class="hljs-string">'posts'</span>,
} : <span class="hljs-literal">null</span>);
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="lazy-initializer-function-which-returns-falsy-value"></a><a href="#lazy-initializer-function-which-returns-falsy-value" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lazy initializer function which returns falsy value</h4>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">const</span> getPost = <span class="hljs-function">(<span class="hljs-params">id?: <span class="hljs-built_in">string</span></span>) =&gt;</span>
  id
    ? ({
        id,
        op: <span class="hljs-string">'getOne'</span>,
        <span class="hljs-keyword">type</span>: <span class="hljs-string">'posts'</span>,
      } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> satisfies IGetOneExpression&lt;<span class="hljs-keyword">typeof</span> Post&gt;)
    : <span class="hljs-literal">null</span>;

<span class="hljs-keyword">const</span> getPostCommentsRelationshipQuery = <span class="hljs-function">(<span class="hljs-params">postId?: <span class="hljs-built_in">string</span></span>) =&gt;</span>
  postId
    ? ({
        id: postId,
        op: <span class="hljs-string">'getRelatedResources'</span>,
        relationship: <span class="hljs-string">'comments'</span>,
        <span class="hljs-keyword">type</span>: <span class="hljs-string">'posts'</span>,
      } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> satisfies IGetRelatedResourcesExpression&lt;<span class="hljs-keyword">typeof</span> Post&gt;)
    : <span class="hljs-literal">null</span>;

<span class="hljs-keyword">const</span> { data: post } = useDatx(getPost(postId));
<span class="hljs-keyword">const</span> { data: comments } = useDatx(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> getPostCommentsRelationshipQuery(postId));

</code></pre>
<h4><a class="anchor" aria-hidden="true" id="lazy-initializer-function-which-throws-an-error-if-some-property-is-not-defined"></a><a href="#lazy-initializer-function-which-throws-an-error-if-some-property-is-not-defined" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lazy initializer function which throws an error if some property is not defined</h4>
<pre><code class="hljs css language-ts"><span class="hljs-keyword">const</span> getPost = <span class="hljs-function">(<span class="hljs-params">id?: <span class="hljs-built_in">string</span></span>) =&gt;</span>
  id
    ? ({
        id,
        op: <span class="hljs-string">'getOne'</span>,
        <span class="hljs-keyword">type</span>: <span class="hljs-string">'posts'</span>,
      } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> satisfies IGetOneExpression&lt;<span class="hljs-keyword">typeof</span> Post&gt;)
    : <span class="hljs-literal">null</span>;

<span class="hljs-keyword">const</span> getTodoByUserQuery = <span class="hljs-function">(<span class="hljs-params">user: User</span>) =&gt;</span>
  ({
    id: user.todo.id, <span class="hljs-comment">// if user is not defined this will throw an error</span>
    op: <span class="hljs-string">'getOne'</span>,
    <span class="hljs-keyword">type</span>: <span class="hljs-string">'todos'</span>,
  } <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span> satisfies IGetOneExpression&lt;<span class="hljs-keyword">typeof</span> Todo&gt;);

<span class="hljs-keyword">const</span> { data: user } = useDatx(getUserQuery(id));
<span class="hljs-keyword">const</span> { data: todo } = useDatx(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> getTodoByUserQuery(user)); <span class="hljs-comment">// it will not fetch the data if user is not defined</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="define-mutations"></a><a href="#define-mutations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Define mutations</h3>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// src/components/features/todos/Todos.mutations.ts</span>

<span class="hljs-keyword">import</span> { getModelEndpointUrl, modelToJsonApi } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/jsonapi'</span>;
<span class="hljs-keyword">import</span> { IClientInstance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/swr'</span>;

<span class="hljs-keyword">import</span> { Todo } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../models/Todo'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> createTodo = <span class="hljs-function">(<span class="hljs-params">client: IClientInstance, message: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span></span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> Todo({ message });
  <span class="hljs-keyword">const</span> url = getModelEndpointUrl(model);
  <span class="hljs-keyword">const</span> data = modelToJsonApi(model);

  <span class="hljs-keyword">return</span> client.request&lt;Todo, <span class="hljs-built_in">Array</span>&lt;Todo&gt;&gt;(url, <span class="hljs-string">'POST'</span>, { data });
};
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="ssr"></a><a href="#ssr" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SSR</h3>
<p>You will use the <code>fetchQuery</code> method inside <code>getServerSideProps</code> to fetch the data and pass the fallback to the page for hydration.</p>
<pre><code class="hljs css language-tsx">type HomeProps = InferGetServerSidePropsType&lt;<span class="hljs-keyword">typeof</span> getServerSideProps&gt;;

<span class="hljs-keyword">const</span> Home: NextPage&lt;SSRProps&gt; = <span class="hljs-function">(<span class="hljs-params">{ fallback }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Hydrate</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{fallback}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Layout</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Todos</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Layout</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Hydrate</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getServerSideProps = <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> client = createClient();

  <span class="hljs-keyword">const</span> todo = <span class="hljs-keyword">await</span> client.fetchQuery(todosQuery);

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">props</span>: {
      <span class="hljs-attr">fallback</span>: client.fallback,
    },
  };
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Home;
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="use-data-fetching-and-mutations-together"></a><a href="#use-data-fetching-and-mutations-together" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use data fetching and mutations together</h3>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// src/components/features/todos/Todos.ts</span>

<span class="hljs-keyword">import</span> { useMutation, useDatx } <span class="hljs-keyword">from</span> <span class="hljs-string">'@datx/swr'</span>;
<span class="hljs-keyword">import</span> { FC, useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { ErrorFallback } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../shared/errors/ErrorFallback/ErrorFallback'</span>;
<span class="hljs-keyword">import</span> NextLink <span class="hljs-keyword">from</span> <span class="hljs-string">'next/link'</span>;

<span class="hljs-keyword">import</span> { createTodo } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Todos.mutations'</span>;
<span class="hljs-keyword">import</span> { todosQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Todos.queries'</span>;

<span class="hljs-keyword">export</span> interface ITodosProps {}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> Todos: FC = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> inputRef = useRef&lt;HTMLInputElement&gt;(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> { data, error, mutate } = useDatx(todosQuery);

  <span class="hljs-keyword">const</span> [create, { status }] = useMutation(createTodo, {
    <span class="hljs-attr">onSuccess</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> input = inputRef.current;
      <span class="hljs-keyword">if</span> (input) input.value = <span class="hljs-string">''</span>;
      mutate();
    },
  });

  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorFallback</span> <span class="hljs-attr">error</span>=<span class="hljs-string">{error}</span> /&gt;</span></span>;
  }

  <span class="hljs-keyword">if</span> (!data) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{status</span> === <span class="hljs-string">'running'</span>} /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> create(inputRef.current?.value)} disabled={status === 'running'}&gt;
        add
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {data.data?.map((todo) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">NextLink</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">.</span>/<span class="hljs-attr">todos</span>/${<span class="hljs-attr">todo.id</span>}`} <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">display:</span> '<span class="hljs-attr">block</span>' }}&gt;</span>{todo.message}<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">NextLink</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="disable-mobx-in-nextjs-projects"></a><a href="#disable-mobx-in-nextjs-projects" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Disable Mobx in Next.js projects</h2>
<p>Since we don't want to use Mobx, we need to add a little boilerplate to work around that. First, we need to instruct DatX not to use Mobx, by adding <code>@datx/core/disable-mobx</code> before App bootstrap:</p>
<pre><code class="hljs css language-tsx"><span class="hljs-comment">// src/pages/_app.tsx</span>

<span class="hljs-meta"><span class="hljs-meta-keyword">import</span> '@datx/core/disable-mobx';</span>
</code></pre>
<p>Next, we need to overwrite Mobx path so that it can be resolved by Datx:</p>
<pre><code class="hljs css language-json"><span class="hljs-comment">// /tsconfig.json</span>

{
  <span class="hljs-attr">"compilerOptions"</span>: {
    <span class="hljs-attr">"paths"</span>: {
      <span class="hljs-attr">"mobx"</span>: [<span class="hljs-string">"./mobx.js"</span>]
    }
  }
}
</code></pre>
<blockquote>
<p><code>./mobx.js</code> is an empty file!</p>
</blockquote>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 4/21/2023 by Ivica Batinic</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/next/jsonapi-angular/mixin"><span class="arrow-prev">← </span><span>Angular JSON:API mixin</span></a><a class="docs-next button" href="/docs/next/jsonapi-swr/api"><span>API</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#install">Install</a></li><li><a href="#basic-usage-with-nextjs">Basic usage with Next.js</a><ul class="toc-headings"><li><a href="#datx-client-initializer-function">Datx Client initializer function</a></li><li><a href="#client-types-override">Client types override</a></li><li><a href="#client-initialization">Client initialization</a></li><li><a href="#define-models">Define models</a></li><li><a href="#define-queries">Define queries</a></li><li><a href="#query-naming-convention">Query naming convention</a></li><li><a href="#conditional-data-fetching">Conditional data fetching</a></li><li><a href="#define-mutations">Define mutations</a></li><li><a href="#ssr">SSR</a></li><li><a href="#use-data-fetching-and-mutations-together">Use data fetching and mutations together</a></li></ul></li><li><a href="#disable-mobx-in-nextjs-projects">Disable Mobx in Next.js projects</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2023 infinum</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f03607e57957ae747b2342443460477a',
                indexName: 'datx',
                inputSelector: '#search_input_react'
              });
            </script></body></html>